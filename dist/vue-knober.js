!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("vue-knober",[],t):"object"==typeof exports?exports["vue-knober"]=t():e["vue-knober"]=t()}(window,function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/dist/",n(n.s=2)}([function(e,t,n){(function(t){var n="Expected a function",i=NaN,r="[object Symbol]",o=/^\s+|\s+$/g,a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt,c="object"==typeof t&&t&&t.Object===Object&&t,h="object"==typeof self&&self&&self.Object===Object&&self,f=c||h||Function("return this")(),d=Object.prototype.toString,b=Math.max,p=Math.min,v=function(){return f.Date.now()};function m(e,t,i){var r,o,a,s,l,u,c=0,h=!1,f=!1,d=!0;if("function"!=typeof e)throw new TypeError(n);function m(t){var n=r,i=o;return r=o=void 0,c=t,s=e.apply(i,n)}function y(e){var n=e-u;return void 0===u||n>=t||n<0||f&&e-c>=a}function S(){var e=v();if(y(e))return z(e);l=setTimeout(S,function(e){var n=t-(e-u);return f?p(n,a-(e-c)):n}(e))}function z(e){return l=void 0,d&&r?m(e):(r=o=void 0,s)}function x(){var e=v(),n=y(e);if(r=arguments,o=this,u=e,n){if(void 0===l)return function(e){return c=e,l=setTimeout(S,t),h?m(e):s}(u);if(f)return l=setTimeout(S,t),m(u)}return void 0===l&&(l=setTimeout(S,t)),s}return t=w(t)||0,g(i)&&(h=!!i.leading,a=(f="maxWait"in i)?b(w(i.maxWait)||0,t):a,d="trailing"in i?!!i.trailing:d),x.cancel=function(){void 0!==l&&clearTimeout(l),c=0,r=u=o=l=void 0},x.flush=function(){return void 0===l?s:z(v())},x}function g(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function w(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&d.call(e)==r}(e))return i;if(g(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=g(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(o,"");var n=s.test(e);return n||l.test(e)?u(e.slice(2),n?2:8):a.test(e)?i:+e}e.exports=function(e,t,i){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError(n);return g(i)&&(r="leading"in i?!!i.leading:r,o="trailing"in i?!!i.trailing:o),m(e,t,{leading:r,maxWait:t,trailing:o})}}).call(this,n(1))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";n.r(t);var i=n(0);var r=function(e,t,n,i,r,o,a,s){var l,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),i&&(u.functional=!0),o&&(u._scopeId="data-v-"+o),a?(l=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=l):r&&(l=s?function(){r.call(this,this.$root.$options.shadowRoot)}:r),l)if(u.functional){u._injectStyles=l;var c=u.render;u.render=function(e,t){return l.call(t),c(e,t)}}else{var h=u.beforeCreate;u.beforeCreate=h?[].concat(h,l):[l]}return{exports:e,options:u}}({name:"lamp-control",data:function(){return{width:0,height:0,brightness:Number(this.value||0),margin:25,chassisSize:0,knobSize:0,ctx:null,start:null,maxAngle:-30,minAngle:-150,initialAngle:-30,currentValue:this.value}},props:{size:{type:[String,Number],default:250},value:{type:[String,Number],default:0},min:{type:[String,Number],default:0},max:{type:[String,Number],default:255}},watch:{},created(){const e=Number(this.size);this.margin=.05*e,this.chassisSize=e/2-this.margin,this.knobSize=.4*this.chassisSize},methods:{calculateRenderParams(e,t){const n=this.size,i=e-n/2,r=t-n/2,o=Math.sqrt(Math.pow(Math.abs(i),2)+Math.pow(Math.abs(r),2));let a=180*Math.atan2(r,i)/Math.PI-180;return a<-180&&(a=Math.abs(a+360)),{r:o,angle:a,coorX:i,coorY:r}},move:n.n(i)()(function(e){const{angle:t,r:n,coorX:i,coorY:r}=e;t<-180&&(t=Math.abs(t+360)),n<this.chassisSize?this.draw(t,n,i,r):this.draw()},40,{trailing:!1}),calculateValue(e){const t=(this.max-this.min)/240;let n;return e>0?n=t*(e+30):e>=-30?n=t*(30+e):e<=-150&&(n=t*(210+e+180)),n&&n.toFixed(0)},press(e){const{angle:t,r:n,coorX:i,coorY:r}=e,o=this.calculateValue(t);n>this.chassisSize||(n<=this.knobSize?this.currentValue>0?this.currentValue=0:this.currentValue=255:o&&(this.initialAngle=t,this.currentValue=Number(o)))},drawKnob(e,t,n,i){const r=this,o=r.knobSize,a=this.ctx;void 0===e||e<-30&&e>-150?e=this.initialAngle:t>r.knobSize&&t>=r.knobSize&&e<0&&(e<=-30&&e>=-90?e=-30:e>-150&&e<-90&&(e=-150)),function(){const e=t<r.knobSize?.2*o:.5*o,n=t<r.knobSize?.05*o:.1*o;a.save(),a.translate(r.size/2,r.size/2),a.beginPath(),a.arc(0,0,o,0,2*Math.PI,!0),a.shadowBlur=e,a.shadowColor="#aaa",a.shadowOffsetX=n,a.shadowOffsetY=n,a.fillStyle="#fff",a.fill(),a.closePath(),a.restore()}(),(!t||t>this.knobSize)&&(a.save(),a.translate(r.size/2,r.size/2),a.rotate(e*Math.PI/180),a.rotate(0),a.beginPath(),a.moveTo(.6*-o,0),a.lineTo(.9*-o,0),a.lineWidth=.015*r.size,a.strokeStyle="#63b98b",a.stroke(),a.closePath(),a.restore()),function(){const e=.3*r.knobSize;let n="#ccc";t<r.knobSize&&(n=r.currentValue>0?"#fe4365":"#79bd9a");a.save(),a.translate(r.size/2,r.size/2),a.rotate(-125*Math.PI/180),a.beginPath(),a.arc(0,0,.3*r.knobSize,0,2*Math.PI-5,!0),a.lineWidth=.2*e,a.strokeStyle=n,a.shadowBlur=.3*e,a.shadowColor=n,a.lineCap="round",a.stroke(),a.restore(),a.save(),a.translate(r.size/2,r.size/2),a.beginPath(),a.moveTo(0,0),a.lineTo(0,1.2*-e),a.lineWidth=.2*e,a.strokeStyle=n,a.shadowBlur=.3*e,a.shadowColor=n,a.lineCap="round",a.stroke(),a.closePath(),a.restore()}()},drawDashboard(e,t,n,i){const r=this,o=r.ctx,a=r.size,s=r.chassisSize;(e+=30)<0&&(e=360+e),o.save(),o.translate(a/2,a/2),o.beginPath(),o.arc(0,0,s,0,2*Math.PI,!0),o.shadowBlur=.16*s,o.shadowOffsetX=.03*s,o.shadowOffsetY=.03*s,o.shadowColor="#ccc",o.fillStyle="#fff",o.fill(),o.closePath(),o.restore(),function(){o.save(),o.translate(a/2,a/2),o.rotate(-30*Math.PI/180);let n=0;for(;n<=30;){const i=-r.knobSize-.1*s,a=n%3==0?.9*-s:.75*-s,l=n%3==0?2:1.5,u=8*n;let c="#eee",h="#fff";const f=(e,t)=>()=>{c=e,h=t},d=f("#cff0da","#cff0da"),b=f("#79bd9a","#79bd9a");if(e)if(t>r.knobSize){e>240?u<=r.initialAngle+30&&r.currentValue>0&&b():r.currentValue<=r.min?u<r.initialAngle+30&&u<e?b():(u<=r.initialAngle+30||u<=e)&&d():u<=r.initialAngle+30&&u<=e?b():(u<=r.initialAngle+30||u<=e)&&d()}else u<=r.initialAngle+30&&0!==r.currentValue&&d();else r.currentValue<=r.min?u<r.initialAngle+30&&b():u<=r.initialAngle+30&&b();o.rotate(0===n?0:8*Math.PI/180),o.beginPath(),o.moveTo(i,0),o.lineTo(a,0),o.lineWidth=l,o.shadowBlur=.05*s,o.shadowColor=h,o.shadowOffsetX=0,o.shadowOffsetY=0,o.strokeStyle=c,o.stroke(),o.closePath(),n++}o.restore()}()},drawlabel(e,t,n,i){const r=this.ctx;let o=this.currentValue;if(e&&e<=240&&t>this.knobSize){const t=this.calculateValue(e);t&&(o=t)}r.save(),r.translate(this.size/2,this.size/2+.8*this.chassisSize),r.fillStyle="#999",r.textAlign="center",r.font=`${.3*this.chassisSize}px Arial`,r.fillText(o,0,0),r.restore()},draw(e,t,n,i){this.ctx.clearRect(0,0,this.size,this.size),this.drawDashboard(e,t,n,i),this.drawKnob(e,t,n,i),this.drawlabel(e,t,n,i)},watchCurrentValueHandler(e){let t=240/(this.max-this.min)*e-30;t>180&&(t-=360),this.initialAngle=t,this.draw()}},mounted(){this.ctx=this.$el.getContext("2d"),this.$el.addEventListener("mousemove",e=>this.move(this.calculateRenderParams(e.offsetX,e.offsetY)),!1),this.$el.addEventListener("mouseout",()=>this.draw(),!1),this.$el.addEventListener("click",e=>this.press(this.calculateRenderParams(e.offsetX,e.offsetY)),!1),this.$el.addEventListener("touchmove",e=>{console.log("in touch");const{pageX:t,pageY:n}=e.changedTouches[0];this.move(this.calculateRenderParams(t,n))},!1),this.$el.addEventListener("touchend",e=>{console.log("in touch");const{pageX:t,pageY:n}=e.changedTouches[0];this.press(this.calculateRenderParams(t,n))}),this.$watch("currentValue",e=>{this.$emit("input",e);const t=240/(this.max-this.min)*e-30;this.initialAngle=t,this.draw()},{immediate:!0})}},function(){var e=this.$createElement;return(this._self._c||e)("canvas",{ref:"canvas",attrs:{width:Number(this.size),height:Number(this.size)}})},[],!1,null,null,null);r.options.__file="knober.vue";var o=r.exports;"undefined"!=typeof window&&window.Vue&&window.Vue.component("vue-knober",o);t.default=o}])});
//# sourceMappingURL=vue-knober.js.map